scalar AWSDate

scalar AWSDateTime

scalar AWSJSON

scalar AWSEmail

scalar AWSPhone

input AuthRule {
  allow: AuthStrategy!
  ownerField: String
  identityClaim: String
  groups: [String]
  operations: [AuthOperation]
}

enum AuthStrategy {
  owner
  groups
  private
  public
}

enum AuthOperation {
  create
  read
  update
  delete
}

enum SchoolStatus {
  PROVISIONING
  ACTIVE
  SUSPENDED
  CLOSED
}

enum SubscriptionStatus {
  TRIAL
  ACTIVE
  PAST_DUE
  SUSPENDED
  CANCELLED
}

enum DomainType {
  SUBDOMAIN
  CUSTOM_DOMAIN
}

enum UserType {
  SCHOOL_ADMIN
  STAFF
  PARENT
  STUDENT
}

enum UserStatus {
  INVITED
  ACTIVE
  SUSPENDED
}

enum AudienceType {
  ALL
  PARENTS
  STAFF
  CLASS_ONLY
}

enum FeeCategory {
  TUITION
  LEVY
  UNIFORM
  BOOKS
  TRANSPORT
  LUNCH
  EXAM
  OTHER
}

enum InvoiceStatus {
  DRAFT
  ISSUED
  PARTIALLY_PAID
  PAID
  VOID
}

enum PaymentProvider {
  PAYSTACK
  FLUTTERWAVE
  OTHER
}

enum PaymentIntentStatus {
  INITIATED
  PENDING
  REDIRECTED
  SUCCEEDED
  FAILED
  CANCELLED
  EXPIRED
}

enum PaymentMethod {
  CARD
  TRANSFER
  USSD
  CASH
  MANUAL
}

enum PaymentTxnStatus {
  PENDING
  CONFIRMED
  FAILED
  REVERSED
  REFUNDED
}

enum PaymentTransactionType {
  SCHOOL_FEE
  SUBSCRIPTION
}

enum ProofStatus {
  SUBMITTED
  APPROVED
  REJECTED
}

enum AdjustmentType {
  DISCOUNT
  WAIVER
  PENALTY
  REVERSAL
}

enum AttendanceStatus {
  PRESENT
  ABSENT
  LATE
  EXCUSED
}

enum AssessmentStatus {
  OPEN
  SUBMITTED
  LOCKED
}

enum ReportCardStatus {
  DRAFT
  READY
  PUBLISHED
}

enum MessageChannel {
  WHATSAPP
  SMS
  EMAIL
  IN_APP
}

enum CampaignStatus {
  DRAFT
  SCHEDULED
  SENDING
  COMPLETED
  CANCELLED
}

enum DeliveryStatus {
  PENDING
  SENT
  DELIVERED
  FAILED
}

enum SupportTicketStatus {
  OPEN
  IN_REVIEW
  RESOLVED
  CLOSED
}

enum SupportTicketAuthorType {
  PARENT
  STAFF
}

type DeliveryStatusEntry {
  status: DeliveryStatus!
  at: AWSDateTime!
  providerMessageId: String
  error: String
}

type Plan {
  id: ID!
  code: String!
  name: String!
  description: String
  billingCycle: String!
  basePrice: Float!
  currency: String!
  status: String!
  createdAt: AWSDateTime
  updatedAt: AWSDateTime
}

type AddOn {
  id: ID!
  code: String!
  name: String!
  description: String
  pricingModel: String!
  price: Float!
  status: String!
  createdAt: AWSDateTime
  updatedAt: AWSDateTime
}

type Permission {
  id: ID!
  code: String!
  description: String
}

type School {
  id: ID!
  tenantKey: ID!
  name: String!
  slug: String!
  status: SchoolStatus!
  primaryCity: String
  createdAt: AWSDateTime
  activatedAt: AWSDateTime
  updatedAt: AWSDateTime
  profile: SchoolProfile
  domains: [SchoolDomain]
  subscription: [SchoolSubscription]
}

type SchoolDomain {
  id: ID!
  schoolId: ID!
  type: DomainType!
  hostname: String!
  verified: Boolean!
  verifiedAt: AWSDateTime
  createdAt: AWSDateTime
  updatedAt: AWSDateTime
}

type SchoolProfile {
  id: ID!
  schoolId: ID!
  address: String
  city: String
  state: String
  contactEmail: AWSEmail
  contactPhone: AWSPhone
  logoUrl: String
  heroImageUrl: String
  themeJson: AWSJSON
  updatedAt: AWSDateTime
}

type SchoolSetupState {
  id: ID!
  schoolId: ID!
  stateJson: AWSJSON!
  createdAt: AWSDateTime
  updatedAt: AWSDateTime
}

type SchoolHomePageSection {
  id: ID!
  schoolId: ID!
  type: String!
  contentJson: AWSJSON!
  sortOrder: Int!
  isEnabled: Boolean!
  createdAt: AWSDateTime
  updatedAt: AWSDateTime
}

type SchoolSubscription {
  id: ID!
  schoolId: ID!
  planId: ID!
  status: SubscriptionStatus!
  startAt: AWSDateTime!
  endAt: AWSDateTime
  renewalAt: AWSDateTime
  gracePeriodDays: Int
  notes: String
  addOns: [SchoolSubscriptionAddOn]
  createdAt: AWSDateTime
  updatedAt: AWSDateTime
}

type SchoolSubscriptionAddOn {
  id: ID!
  schoolId: ID!
  subscriptionId: ID!
  addOnId: ID!
  status: String!
  effectiveAt: AWSDateTime!
}

type ProviderConfig {
  id: ID!
  schoolId: ID!
  type: String!
  providerName: String!
  configJson: AWSJSON!
  status: String!
  createdAt: AWSDateTime
  updatedAt: AWSDateTime
}

type User {
  id: ID!
  schoolId: ID!
  email: AWSEmail
  phone: AWSPhone
  name: String!
  userType: UserType!
  status: UserStatus!
  mfaEnabled: Boolean
  lastLoginAt: AWSDateTime
  createdAt: AWSDateTime
  updatedAt: AWSDateTime
  roles: [UserRole]
}

type Role {
  id: ID!
  schoolId: ID!
  name: String!
  isSystemRole: Boolean!
  permissions: [RolePermission]
}

type RolePermission {
  id: ID!
  schoolId: ID!
  roleId: ID!
  permissionCode: String!
}

type UserRole {
  id: ID!
  schoolId: ID!
  userId: ID!
  roleId: ID!
}

type AuditEvent {
  id: ID!
  schoolId: ID!
  actorUserId: ID
  action: String!
  entityType: String!
  entityId: ID!
  beforeJson: AWSJSON
  afterJson: AWSJSON
  ipAddress: String
  userAgent: String
  createdAt: AWSDateTime!
}

type AuditEventConnection {
  items: [AuditEvent]
  nextToken: String
}

type Announcement {
  id: ID!
  schoolId: ID!
  title: String!
  body: String!
  audience: AudienceType!
  classGroupId: ID
  attachmentsJson: AWSJSON
  publishedAt: AWSDateTime!
  expiresAt: AWSDateTime
  createdAt: AWSDateTime
  updatedAt: AWSDateTime
}

type CalendarEvent {
  id: ID!
  schoolId: ID!
  title: String!
  description: String
  startAt: AWSDateTime!
  endAt: AWSDateTime!
  audience: AudienceType!
  classGroupId: ID
  createdAt: AWSDateTime
  updatedAt: AWSDateTime
}

type AcademicSession {
  id: ID!
  schoolId: ID!
  name: String!
  startDate: AWSDate!
  endDate: AWSDate!
  status: String!
  terms: [Term]
}

type Term {
  id: ID!
  schoolId: ID!
  sessionId: ID!
  name: String!
  startDate: AWSDate!
  endDate: AWSDate!
  status: String!
}

type Level {
  id: ID!
  schoolId: ID!
  type: String!
  name: String!
  sortOrder: Int!
}

type ClassYear {
  id: ID!
  schoolId: ID!
  levelId: ID!
  name: String!
  sortOrder: Int!
}

type ClassArm {
  id: ID!
  schoolId: ID!
  name: String!
}

type ClassGroup {
  id: ID!
  schoolId: ID!
  classYearId: ID!
  classArmId: ID
  displayName: String!
  classTeacherUserId: ID
}

type Subject {
  id: ID!
  schoolId: ID!
  name: String!
  code: String
  levelType: String
}

type ClassSubject {
  id: ID!
  schoolId: ID!
  classYearId: ID!
  subjectId: ID!
  isCompulsory: Boolean!
}

type Student {
  id: ID!
  schoolId: ID!
  admissionNo: String!
  firstName: String!
  lastName: String!
  dob: AWSDate
  gender: String
  photoUrl: String
  status: String!
}

type ParentGuardian {
  id: ID!
  schoolId: ID!
  userId: ID
  fullName: String!
  primaryPhone: AWSPhone!
  email: AWSEmail
  preferredChannel: MessageChannel
  optedOut: Boolean
  optedOutChannels: [MessageChannel]
  status: String!
  children: [StudentParentLink]
}

type ImportJob {
  id: ID!
  schoolId: ID!
  bucket: String!
  key: String!
  status: String!
  processedLines: Int
  created: Int
  updated: Int
  skipped: Int
  errors: Int
  errorReportKey: String
  createdAt: AWSDateTime!
  processedAt: AWSDateTime
}

type StudentParentLink {
  id: ID!
  schoolId: ID!
  studentId: ID!
  parentId: ID!
  relationship: String!
  isPrimary: Boolean!
}

type Enrollment {
  id: ID!
  schoolId: ID!
  studentId: ID!
  sessionId: ID!
  termId: ID!
  classGroupId: ID!
  status: String!
}

type FeeItem {
  id: ID!
  schoolId: ID!
  name: String!
  description: String
  category: FeeCategory!
  isOptional: Boolean!
  isActive: Boolean!
}

type FeeSchedule {
  id: ID!
  schoolId: ID!
  sessionId: ID!
  termId: ID!
  classYearId: ID!
  classGroupId: ID
  name: String!
  currency: String!
  isActive: Boolean!
  lines: [FeeScheduleLine]
  createdAt: AWSDateTime
  updatedAt: AWSDateTime
}

type FeeScheduleLine {
  id: ID!
  schoolId: ID!
  feeScheduleId: ID!
  feeItemId: ID!
  amount: Float!
  isOptionalOverride: Boolean
  dueDate: AWSDate
  sortOrder: Int!
}

type DiscountRule {
  id: ID!
  schoolId: ID!
  type: String!
  valueType: String!
  value: Float!
  criteriaJson: AWSJSON
  isActive: Boolean!
}

type Invoice {
  id: ID!
  schoolId: ID!
  invoiceNo: String!
  studentId: ID!
  enrollmentId: ID
  sessionId: ID!
  termId: ID!
  classGroupId: ID
  feeScheduleId: ID
  status: InvoiceStatus!
  issuedAt: AWSDateTime
  dueAt: AWSDateTime
  currency: String
  requiredSubtotal: Float!
  optionalSubtotal: Float!
  discountTotal: Float!
  penaltyTotal: Float!
  amountPaid: Float!
  amountDue: Float!
  lastProcessedAt: AWSDateTime
  lines: [InvoiceLine]
  payments: [PaymentTransaction]
  adjustments: [FeeAdjustment]
}

type InvoiceLine {
  id: ID!
  schoolId: ID!
  invoiceId: ID!
  feeItemId: ID
  label: String!
  description: String
  amount: Float!
  isOptional: Boolean!
  isSelected: Boolean
  sortOrder: Int!
}

type PaymentIntent {
  id: ID!
  schoolId: ID!
  invoiceId: ID!
  payerParentId: ID
  provider: PaymentProvider!
  amount: Float!
  currency: String!
  status: PaymentIntentStatus!
  externalReference: String
  providerReference: String
  redirectedAt: AWSDateTime
  confirmedAt: AWSDateTime
  failedAt: AWSDateTime
  createdAt: AWSDateTime!
  updatedAt: AWSDateTime
}

type PaymentTransaction {
  id: ID!
  schoolId: ID!
  invoiceId: ID
  subscriptionId: ID
  paymentIntentId: ID
  provider: PaymentProvider
  method: PaymentMethod
  amount: Float!
  grossAmount: Float
  netAmount: Float
  providerFee: Float
  currency: String!
  status: PaymentTxnStatus!
  paidAt: AWSDateTime
  reference: String
  providerReference: String
  receiptNo: String
  recordedByUserId: ID
  type: PaymentTransactionType
  environment: String
  metadata: AWSJSON
  providerResponse: AWSJSON
  processedAt: AWSDateTime
  proofs: [ManualPaymentProof]
  allocations: [PaymentAllocation]
}

type Receipt {
  id: ID!
  schoolId: ID!
  receiptNo: String!
  invoiceId: ID!
  paymentTxnId: ID
  paymentReference: String
  amount: Float!
  currency: String!
  receiptUrl: String
  receiptBucket: String
  receiptKey: String
  paidAt: AWSDateTime
  createdAt: AWSDateTime!
}

type PaymentAllocation {
  id: ID!
  schoolId: ID!
  paymentTxnId: ID!
  invoiceId: ID!
  amountAllocated: Float!
}

type ManualPaymentProof {
  id: ID!
  schoolId: ID!
  paymentTxnId: ID!
  fileUrl: String!
  submittedByParentId: ID
  status: ProofStatus!
  reviewedByUserId: ID
  reviewedAt: AWSDateTime
  notes: String
  createdAt: AWSDateTime!
}

type FeeAdjustment {
  id: ID!
  schoolId: ID!
  invoiceId: ID!
  type: AdjustmentType!
  amount: Float!
  reason: String
  createdByUserId: ID!
  approvedByUserId: ID
  approvedAt: AWSDateTime
  createdAt: AWSDateTime!
}

type InstallmentPlan {
  id: ID!
  schoolId: ID!
  invoiceId: ID!
  status: String!
  totalAmount: Float!
  installments: [Installment]
  createdAt: AWSDateTime!
}

type Installment {
  id: ID!
  schoolId: ID!
  installmentPlanId: ID!
  sequenceNo: Int!
  amount: Float!
  dueAt: AWSDateTime!
  status: String!
}

type MessageTemplate {
  id: ID!
  schoolId: ID!
  type: String!
  channel: MessageChannel!
  subject: String
  body: String!
  variablesJson: AWSJSON
  isActive: Boolean!
  createdAt: AWSDateTime
  updatedAt: AWSDateTime
}

type MessageCampaign {
  id: ID!
  schoolId: ID!
  name: String!
  type: String!
  channel: MessageChannel!
  templateId: ID
  createdByUserId: ID!
  status: CampaignStatus!
  scheduledAt: AWSDateTime
  audienceJson: AWSJSON
  recipients: [MessageRecipient]
  createdAt: AWSDateTime!
}

type MessageRecipient {
  id: ID!
  schoolId: ID!
  campaignId: ID!
  parentId: ID
  userId: ID
  destination: String!
  status: DeliveryStatus!
  statusHistory: [DeliveryStatusEntry!]
  providerMessageId: String
  lastError: String
  lastUpdatedAt: AWSDateTime
}

type SupportTicket {
  id: ID!
  schoolId: ID!
  parentId: ID!
  studentId: ID
  subject: String!
  category: String!
  detail: String!
  status: SupportTicketStatus!
  createdAt: AWSDateTime!
  updatedAt: AWSDateTime!
}

type SupportTicketMessage {
  id: ID!
  schoolId: ID!
  ticketId: ID!
  authorType: SupportTicketAuthorType!
  authorId: ID!
  body: String!
  createdAt: AWSDateTime!
}

type AttendanceSession {
  id: ID!
  schoolId: ID!
  termId: ID!
  classGroupId: ID!
  date: AWSDate!
  takenByUserId: ID!
  entries: [AttendanceEntry]
}

type AttendanceEntry {
  id: ID!
  schoolId: ID!
  attendanceSessionId: ID!
  studentId: ID!
  status: AttendanceStatus!
  notes: String
}

type AssessmentPolicy {
  id: ID!
  schoolId: ID!
  name: String!
  appliesTo: String
  componentsJson: AWSJSON!
  gradingScaleJson: AWSJSON
  isActive: Boolean!
}

type Assessment {
  id: ID!
  schoolId: ID!
  termId: ID!
  classGroupId: ID!
  subjectId: ID!
  policyId: ID!
  title: String!
  status: AssessmentStatus!
  scores: [ScoreEntry]
}

type ScoreEntry {
  id: ID!
  schoolId: ID!
  assessmentId: ID!
  studentId: ID!
  scoresJson: AWSJSON!
  totalScore: Float
  grade: String
  enteredByUserId: ID!
  enteredAt: AWSDateTime!
}

type ReportCard {
  id: ID!
  schoolId: ID!
  studentId: ID!
  termId: ID!
  classGroupId: ID!
  status: ReportCardStatus!
  teacherComment: String
  headComment: String
  attendanceSummaryJson: AWSJSON
  publishedAt: AWSDateTime
}

type ResultReleasePolicy {
  id: ID!
  schoolId: ID!
  isEnabled: Boolean!
  minimumPaymentPercent: Int!
  messageToParent: String
  appliesTo: String
}

type FeatureFlag {
  id: ID!
  schoolId: ID!
  code: String!
  isEnabled: Boolean!
  updatedAt: AWSDateTime
}

type GenerateClassInvoicesResult {
  createdCount: Int!
  invoiceIds: [ID!]!
  skippedCount: Int!
}

type Query {
  ping: String
  schoolBySlug(slug: String!): School
  domainsBySchool(schoolId: ID!, limit: Int): [SchoolDomain]
  schoolProfileBySchool(schoolId: ID!, limit: Int): [SchoolProfile]
  setupStateBySchool(schoolId: ID!, limit: Int): [SchoolSetupState]
  homeSectionsBySchool(schoolId: ID!, limit: Int): [SchoolHomePageSection]
  sessionsBySchool(schoolId: ID!, limit: Int): [AcademicSession]
  termsBySession(sessionId: ID!, limit: Int): [Term]
  levelsBySchool(schoolId: ID!, limit: Int): [Level]
  classYearsBySchool(schoolId: ID!, limit: Int): [ClassYear]
  classArmsBySchool(schoolId: ID!, limit: Int): [ClassArm]
  classGroupsBySchool(schoolId: ID!, limit: Int): [ClassGroup]
  subjectsBySchool(schoolId: ID!, limit: Int): [Subject]
  subjectsByClassYear(classYearId: ID!, limit: Int): [ClassSubject]
  usersBySchool(schoolId: ID!, userType: UserType!, limit: Int): [User]
    rolesBySchool(schoolId: ID!, limit: Int): [Role]
    rolePermissionsByRole(roleId: ID!, limit: Int): [RolePermission]
    permissions(limit: Int): [Permission]
    userRolesByUser(userId: ID!, limit: Int): [UserRole]
    auditBySchool(
      schoolId: ID!
      limit: Int
      nextToken: String
      action: String
      entityType: String
      actorUserId: ID
    ): AuditEventConnection
    feeSchedulesByTerm(termId: ID!, classYearId: ID!, limit: Int): [FeeSchedule]
  feeScheduleLinesBySchedule(feeScheduleId: ID!, limit: Int): [FeeScheduleLine]
  discountRulesBySchool(schoolId: ID!, limit: Int): [DiscountRule]
  invoicesByStudent(studentId: ID!, termId: ID!, limit: Int): [Invoice]
  invoicesByTermClassGroup(termId: ID!, classGroupId: ID!, limit: Int): [Invoice]
  invoiceByNumber(schoolId: ID!, invoiceNo: String!): Invoice
  invoiceById(schoolId: ID!, id: ID!): Invoice
  invoiceLinesByInvoice(invoiceId: ID!, limit: Int): [InvoiceLine]
  installmentPlanByInvoice(invoiceId: ID!, limit: Int): [InstallmentPlan]
  paymentIntentsByInvoice(invoiceId: ID!, limit: Int): [PaymentIntent]
  paymentsByInvoice(invoiceId: ID!, limit: Int): [PaymentTransaction]
  paymentsBySchool(schoolId: ID!, limit: Int): [PaymentTransaction]
  receiptsByInvoice(invoiceId: ID!, limit: Int): [Receipt]
  receiptsBySchool(schoolId: ID!, limit: Int): [Receipt]
  receiptByNumber(schoolId: ID!, receiptNo: String!): Receipt
  proofsByPayment(paymentTxnId: ID!, limit: Int): [ManualPaymentProof]
  manualPaymentProofsBySchool(schoolId: ID!, limit: Int): [ManualPaymentProof]
  announcementsBySchool(schoolId: ID!, limit: Int): [Announcement]
  eventsBySchool(schoolId: ID!, limit: Int): [CalendarEvent]
  studentsBySchool(schoolId: ID!, limit: Int): [Student]
  parentsBySchool(schoolId: ID!, limit: Int): [ParentGuardian]
  parentsByStudent(studentId: ID!, limit: Int): [StudentParentLink]
  studentsByParent(parentId: ID!, limit: Int): [StudentParentLink]
  enrollmentsByStudent(studentId: ID!, limit: Int): [Enrollment]
  enrollmentsByTermClassGroup(termId: ID!, classGroupId: ID!, limit: Int): [Enrollment]
  importJobsBySchool(schoolId: ID!, limit: Int): [ImportJob]
  feeItemsBySchool(schoolId: ID!, limit: Int): [FeeItem]
  providerConfigsBySchool(schoolId: ID!, limit: Int): [ProviderConfig]
  plans(limit: Int): [Plan]
  planById(id: ID!): Plan
  addOns(limit: Int): [AddOn]
  templatesBySchool(schoolId: ID!, limit: Int): [MessageTemplate]
  campaignsBySchool(schoolId: ID!, limit: Int): [MessageCampaign]
  recipientsByCampaign(campaignId: ID!, limit: Int): [MessageRecipient]
  recipientsByInvoice(invoiceId: ID!, limit: Int): [MessageRecipient]
  attendanceSessionsByClassAndDay(classGroupId: ID!, date: AWSDate!, limit: Int): [AttendanceSession]
  attendanceEntriesBySession(attendanceSessionId: ID!, limit: Int): [AttendanceEntry]
  assessmentPoliciesBySchool(schoolId: ID!, limit: Int): [AssessmentPolicy]
  assessmentsByClassSubjectTerm(classGroupId: ID!, subjectId: ID!, termId: ID, limit: Int): [Assessment]
  scoresByAssessment(assessmentId: ID!, limit: Int): [ScoreEntry]
  featuresBySchool(schoolId: ID!, limit: Int): [FeatureFlag]
  releasePolicyBySchool(schoolId: ID!, limit: Int): [ResultReleasePolicy]
  reportCardsByStudentTerm(studentId: ID!, termId: ID!, limit: Int): [ReportCard]
  defaultersByClass(termId: ID!, classGroupId: ID!, minDaysOverdue: Int = 0, minAmountDue: Float = 0): [Invoice]
  supportTicketById(schoolId: ID!, id: ID!): SupportTicket
  supportTicketsByParent(parentId: ID!, limit: Int): [SupportTicket]
  supportTicketsBySchool(schoolId: ID!, limit: Int): [SupportTicket]
  supportTicketMessagesByTicket(ticketId: ID!, limit: Int): [SupportTicketMessage]
}

type Mutation {
  publishEvent(detailType: String!, source: String!, detail: AWSJSON!): Boolean
  enqueueInvoicingJob(detail: AWSJSON!, detailType: String = "invoice.generated", source: String = "classpoint.billing"): Boolean
  enqueueMessagingJob(detail: AWSJSON!, detailType: String = "messaging.requested", source: String = "classpoint.messaging"): Boolean
  enqueueImportJob(detail: AWSJSON!, detailType: String = "import.requested", source: String = "classpoint.imports"): Boolean
  createMessageTemplate(input: CreateMessageTemplateInput!): MessageTemplate
  updateMessageTemplate(input: UpdateMessageTemplateInput!): MessageTemplate
  deleteMessageTemplate(schoolId: ID!, id: ID!): Boolean
  createPlan(input: CreatePlanInput!): Plan
  updatePlan(input: UpdatePlanInput!): Plan
  deletePlan(id: ID!): Boolean
  createAddOn(input: CreateAddOnInput!): AddOn
  updateAddOn(input: UpdateAddOnInput!): AddOn
  deleteAddOn(id: ID!): Boolean
  createProviderConfig(input: CreateProviderConfigInput!): ProviderConfig
  updateProviderConfig(input: UpdateProviderConfigInput!): ProviderConfig
  deleteProviderConfig(schoolId: ID!, id: ID!): Boolean
  createSchoolSetupState(input: CreateSchoolSetupStateInput!): SchoolSetupState
  updateSchoolSetupState(input: UpdateSchoolSetupStateInput!): SchoolSetupState
  createMessageCampaign(input: CreateMessageCampaignInput!): MessageCampaign
  updateMessageCampaignStatus(schoolId: ID!, id: ID!, status: CampaignStatus!, scheduledAt: AWSDateTime): MessageCampaign
  emitAnnouncementNotification(schoolId: ID!, announcementId: ID!): Boolean
  emitResultReadyNotification(schoolId: ID!, studentId: ID!, classGroupId: ID, termId: ID!): Boolean
  publishAnnouncement(schoolId: ID!, announcementId: ID!, audience: AudienceType, classGroupId: ID, termId: ID): Boolean
  publishResultReady(schoolId: ID!, studentId: ID!, classGroupId: ID, termId: ID!, reportCardId: ID): Boolean
  createAttendanceSession(input: CreateAttendanceSessionInput!): AttendanceSession
  createAttendanceEntry(input: CreateAttendanceEntryInput!): AttendanceEntry
  createAssessment(input: CreateAssessmentInput!): Assessment
  createScoreEntry(input: CreateScoreEntryInput!): ScoreEntry
  updateScoreEntry(input: UpdateScoreEntryInput!): ScoreEntry
  lockAssessment(schoolId: ID!, id: ID!): Assessment
  unlockAssessment(schoolId: ID!, id: ID!): Assessment
  sendDefaulterReminders(input: SendDefaulterRemindersInput!): Boolean
  createResultReleasePolicy(input: CreateResultReleasePolicyInput!): ResultReleasePolicy
  updateResultReleasePolicy(input: UpdateResultReleasePolicyInput!): ResultReleasePolicy
  deleteResultReleasePolicy(schoolId: ID!, id: ID!): Boolean
  seedDefaultMessageTemplates(schoolId: ID!, channel: MessageChannel = WHATSAPP): Boolean
  provisionSchool(input: ProvisionSchoolInput!): School
  createSchoolProfile(input: CreateSchoolProfileInput!): SchoolProfile
  updateSchoolProfile(input: UpdateSchoolProfileInput!): SchoolProfile
  createSchoolHomePageSection(input: CreateSchoolHomePageSectionInput!): SchoolHomePageSection
  updateSchoolHomePageSection(input: UpdateSchoolHomePageSectionInput!): SchoolHomePageSection
  deleteSchoolHomePageSection(schoolId: ID!, id: ID!): Boolean
  createAcademicSession(input: CreateAcademicSessionInput!): AcademicSession
  updateAcademicSession(input: UpdateAcademicSessionInput!): AcademicSession
  deleteAcademicSession(schoolId: ID!, id: ID!): Boolean
  createTerm(input: CreateTermInput!): Term
  updateTerm(input: UpdateTermInput!): Term
  deleteTerm(schoolId: ID!, id: ID!): Boolean
  createLevel(input: CreateLevelInput!): Level
  updateLevel(input: UpdateLevelInput!): Level
  deleteLevel(schoolId: ID!, id: ID!): Boolean
  createClassYear(input: CreateClassYearInput!): ClassYear
  updateClassYear(input: UpdateClassYearInput!): ClassYear
  deleteClassYear(schoolId: ID!, id: ID!): Boolean
  createClassArm(input: CreateClassArmInput!): ClassArm
  updateClassArm(input: UpdateClassArmInput!): ClassArm
  deleteClassArm(schoolId: ID!, id: ID!): Boolean
  createClassGroup(input: CreateClassGroupInput!): ClassGroup
  updateClassGroup(input: UpdateClassGroupInput!): ClassGroup
  deleteClassGroup(schoolId: ID!, id: ID!): Boolean
  createSubject(input: CreateSubjectInput!): Subject
  updateSubject(input: UpdateSubjectInput!): Subject
  deleteSubject(schoolId: ID!, id: ID!): Boolean
  createClassSubject(input: CreateClassSubjectInput!): ClassSubject
  updateClassSubject(input: UpdateClassSubjectInput!): ClassSubject
  deleteClassSubject(schoolId: ID!, id: ID!): Boolean
  createUser(input: CreateUserInput!): User
  inviteStaffUser(input: InviteStaffUserInput!): User
  createRole(input: CreateRoleInput!): Role
    updateRole(input: UpdateRoleInput!): Role
    deleteRole(input: DeleteRoleInput!): Boolean
    assignUserRole(input: AssignUserRoleInput!): UserRole
    removeUserRole(input: RemoveUserRoleInput!): Boolean
    assignRolePermission(input: AssignRolePermissionInput!): RolePermission
    removeRolePermission(input: RemoveRolePermissionInput!): Boolean
  createImportJob(input: CreateImportJobInput!): ImportJob
  createImportUploadUrl(input: CreateImportUploadUrlInput!): PresignedUpload
  createImportErrorDownloadUrl(input: CreateImportErrorDownloadUrlInput!): PresignedDownload
  createFeeItem(input: CreateFeeItemInput!): FeeItem
    updateFeeItem(input: UpdateFeeItemInput!): FeeItem
    deleteFeeItem(schoolId: ID!, id: ID!): Boolean
    createFeeAdjustment(input: CreateFeeAdjustmentInput!): FeeAdjustment
    createFeeSchedule(input: CreateFeeScheduleInput!): FeeSchedule
    updateFeeSchedule(input: UpdateFeeScheduleInput!): FeeSchedule
  deleteFeeSchedule(schoolId: ID!, id: ID!): Boolean
  createFeeScheduleLine(input: CreateFeeScheduleLineInput!): FeeScheduleLine
  updateFeeScheduleLine(input: UpdateFeeScheduleLineInput!): FeeScheduleLine
  deleteFeeScheduleLine(schoolId: ID!, id: ID!): Boolean
  generateClassInvoices(input: GenerateClassInvoicesInput!): GenerateClassInvoicesResult
  createInvoice(input: CreateInvoiceInput!): Invoice
  selectInvoiceOptionalItems(input: SelectInvoiceOptionalItemsInput!): Invoice
  createPaymentIntent(input: CreatePaymentIntentInput!): PaymentIntent
  createPaymentTransaction(input: CreatePaymentTransactionInput!): PaymentTransaction
  updatePaymentIntent(input: UpdatePaymentIntentInput!): PaymentIntent
  createManualPaymentProofUploadUrl(input: CreateManualPaymentProofUploadUrlInput!): PresignedUpload
  submitManualPaymentProof(input: SubmitManualPaymentProofInput!): ManualPaymentProof
  reviewManualPaymentProof(input: ReviewManualPaymentProofInput!): ManualPaymentProof
  createReceiptUploadUrl(input: CreateReceiptUploadUrlInput!): PresignedUpload
  attachReceiptUrl(input: AttachReceiptUrlInput!): Receipt
  createReceiptDownloadUrl(input: CreateReceiptDownloadUrlInput!): PresignedDownload
  createSupportTicket(input: CreateSupportTicketInput!): SupportTicket
  updateSupportTicketStatus(input: UpdateSupportTicketStatusInput!): SupportTicket
  createSupportTicketMessage(input: CreateSupportTicketMessageInput!): SupportTicketMessage
}

input ProvisionSchoolInput {
  name: String!
  slug: String!
  primaryCity: String
  address: String
  city: String
  state: String
  contactEmail: AWSEmail
  contactPhone: AWSPhone
}

input CreateSchoolProfileInput {
  schoolId: ID!
  address: String
  city: String
  state: String
  contactEmail: AWSEmail
  contactPhone: AWSPhone
  logoUrl: String
  heroImageUrl: String
  themeJson: AWSJSON
}

input CreateSchoolSetupStateInput {
  id: ID!
  schoolId: ID!
  stateJson: AWSJSON!
}

input UpdateSchoolSetupStateInput {
  id: ID!
  schoolId: ID!
  stateJson: AWSJSON!
}

input UpdateSchoolProfileInput {
  schoolId: ID!
  id: ID!
  address: String
  city: String
  state: String
  contactEmail: AWSEmail
  contactPhone: AWSPhone
  logoUrl: String
  heroImageUrl: String
  themeJson: AWSJSON
}

input CreateSchoolHomePageSectionInput {
  schoolId: ID!
  type: String!
  contentJson: AWSJSON!
  sortOrder: Int!
  isEnabled: Boolean = true
}

input UpdateSchoolHomePageSectionInput {
  schoolId: ID!
  id: ID!
  type: String!
  contentJson: AWSJSON!
  sortOrder: Int!
  isEnabled: Boolean!
}

input CreateAcademicSessionInput {
  schoolId: ID!
  name: String!
  startDate: AWSDate!
  endDate: AWSDate!
  status: String!
}

input UpdateAcademicSessionInput {
  schoolId: ID!
  id: ID!
  name: String!
  startDate: AWSDate!
  endDate: AWSDate!
  status: String!
}

input CreateTermInput {
  schoolId: ID!
  sessionId: ID!
  name: String!
  startDate: AWSDate!
  endDate: AWSDate!
  status: String!
}

input UpdateTermInput {
  schoolId: ID!
  id: ID!
  sessionId: ID!
  name: String!
  startDate: AWSDate!
  endDate: AWSDate!
  status: String!
}

input CreateLevelInput {
  schoolId: ID!
  type: String!
  name: String!
  sortOrder: Int!
}

input UpdateLevelInput {
  schoolId: ID!
  id: ID!
  type: String!
  name: String!
  sortOrder: Int!
}

input CreateClassYearInput {
  schoolId: ID!
  levelId: ID!
  name: String!
  sortOrder: Int!
}

input UpdateClassYearInput {
  schoolId: ID!
  id: ID!
  levelId: ID!
  name: String!
  sortOrder: Int!
}

input CreateClassArmInput {
  schoolId: ID!
  name: String!
}

input UpdateClassArmInput {
  schoolId: ID!
  id: ID!
  name: String!
}

input CreateClassGroupInput {
  schoolId: ID!
  classYearId: ID!
  classArmId: ID
  displayName: String!
  classTeacherUserId: ID
}

input CreateUserInput {
  schoolId: ID!
  name: String!
  email: AWSEmail
  phone: AWSPhone
  userType: UserType!
  status: UserStatus = INVITED
}

input InviteStaffUserInput {
  schoolId: ID!
  name: String!
  email: AWSEmail
  phone: AWSPhone
  userType: UserType! # SCHOOL_ADMIN/STAFF/TEACHER/BURSAR
  tempPassword: String
}

input UpdateClassGroupInput {
  schoolId: ID!
  id: ID!
  classYearId: ID!
  classArmId: ID
  displayName: String!
  classTeacherUserId: ID
}

input CreateSubjectInput {
  schoolId: ID!
  name: String!
  code: String
  levelType: String
}

input UpdateSubjectInput {
  schoolId: ID!
  id: ID!
  name: String!
  code: String
  levelType: String
}

input CreateClassSubjectInput {
  schoolId: ID!
  classYearId: ID!
  subjectId: ID!
  isCompulsory: Boolean!
}

input UpdateClassSubjectInput {
  schoolId: ID!
  id: ID!
  classYearId: ID!
  subjectId: ID!
  isCompulsory: Boolean!
}

input CreateRoleInput {
  schoolId: ID!
  name: String!
  createdByUserId: ID
}

input UpdateRoleInput {
  schoolId: ID!
  id: ID!
  name: String!
  updatedByUserId: ID
}

input DeleteRoleInput {
  schoolId: ID!
  id: ID!
  deletedByUserId: ID
}

input AssignUserRoleInput {
  schoolId: ID!
  userId: ID!
  roleId: ID!
  assignedByUserId: ID
}

input RemoveUserRoleInput {
  schoolId: ID!
  userId: ID!
  roleId: ID!
  removedByUserId: ID
}

input AssignRolePermissionInput {
  schoolId: ID!
  roleId: ID!
  permissionCode: String!
  assignedByUserId: ID
}

input RemoveRolePermissionInput {
  schoolId: ID!
  roleId: ID!
  permissionCode: String!
  removedByUserId: ID
}

input CreateImportJobInput {
  schoolId: ID!
  bucket: String!
  key: String!
}

input CreateImportUploadUrlInput {
  schoolId: ID!
  fileName: String!
  contentType: String = "text/csv"
}

input CreateImportErrorDownloadUrlInput {
  schoolId: ID!
  key: String!
}

type PresignedUpload {
  uploadUrl: String!
  bucket: String!
  key: String!
  expiresIn: Int!
}

type PresignedDownload {
  downloadUrl: String!
  bucket: String!
  key: String!
  expiresIn: Int!
}

input CreateFeeItemInput {
  schoolId: ID!
  name: String!
  description: String
  category: FeeCategory!
  isOptional: Boolean!
  isActive: Boolean = true
}

input UpdateFeeItemInput {
  schoolId: ID!
  id: ID!
  name: String!
  description: String
  category: FeeCategory!
  isOptional: Boolean!
  isActive: Boolean!
}

input CreatePlanInput {
  code: String!
  name: String!
  description: String
  billingCycle: String!
  basePrice: Float!
  currency: String!
  status: String!
}

input UpdatePlanInput {
  id: ID!
  code: String!
  name: String!
  description: String
  billingCycle: String!
  basePrice: Float!
  currency: String!
  status: String!
}

input CreateAddOnInput {
  code: String!
  name: String!
  description: String
  pricingModel: String!
  price: Float!
  status: String!
}

input UpdateAddOnInput {
  id: ID!
  code: String!
  name: String!
  description: String
  pricingModel: String!
  price: Float!
  status: String!
}

input CreateProviderConfigInput {
  schoolId: ID!
  type: String!
  providerName: String!
  configJson: AWSJSON!
  status: String!
}

input UpdateProviderConfigInput {
  schoolId: ID!
  id: ID!
  type: String!
  providerName: String!
  configJson: AWSJSON!
  status: String!
}

input CreateAttendanceSessionInput {
  schoolId: ID!
  termId: ID!
  classGroupId: ID!
  date: AWSDate!
  takenByUserId: ID!
}

input CreateAttendanceEntryInput {
  schoolId: ID!
  attendanceSessionId: ID!
  studentId: ID!
  status: AttendanceStatus!
  notes: String
}

input CreateAssessmentInput {
  schoolId: ID!
  termId: ID!
  classGroupId: ID!
  subjectId: ID!
  policyId: ID!
  title: String!
  status: AssessmentStatus = OPEN
}

input CreateScoreEntryInput {
  schoolId: ID!
  assessmentId: ID!
  studentId: ID!
  scoresJson: AWSJSON!
  totalScore: Float
  grade: String
  enteredByUserId: ID!
  enteredAt: AWSDateTime!
}

input UpdateScoreEntryInput {
  schoolId: ID!
  id: ID!
  assessmentId: ID!
  studentId: ID!
  scoresJson: AWSJSON
  totalScore: Float
  grade: String
}

input SendDefaulterRemindersInput {
  schoolId: ID!
  termId: ID
  classGroupId: ID
  invoiceIds: [ID!]!
  templateType: String = "OVERDUE_NOTICE"
  source: String = "classpoint.collections"
  detailType: String = "messaging.requested"
  retryOnFail: Boolean = true
}

input CreateResultReleasePolicyInput {
  schoolId: ID!
  isEnabled: Boolean!
  minimumPaymentPercent: Int!
  messageToParent: String
  appliesTo: String
}

input UpdateResultReleasePolicyInput {
  schoolId: ID!
  id: ID!
  isEnabled: Boolean!
  minimumPaymentPercent: Int!
  messageToParent: String
  appliesTo: String
}

input CreateFeeAdjustmentInput {
  schoolId: ID!
  invoiceId: ID!
  type: AdjustmentType!
  amount: Float!
  reason: String
  createdByUserId: ID!
  approvedByUserId: ID
  approvedAt: AWSDateTime
}

input CreateFeeScheduleInput {
  schoolId: ID!
  sessionId: ID!
  termId: ID!
  classYearId: ID!
  classGroupId: ID
  name: String!
  currency: String!
  isActive: Boolean = true
}

input UpdateFeeScheduleInput {
  schoolId: ID!
  id: ID!
  sessionId: ID!
  termId: ID!
  classYearId: ID!
  classGroupId: ID
  name: String!
  currency: String!
  isActive: Boolean!
}

input CreateFeeScheduleLineInput {
  schoolId: ID!
  feeScheduleId: ID!
  feeItemId: ID!
  amount: Float!
  isOptionalOverride: Boolean
  dueDate: AWSDate
  sortOrder: Int!
}

input UpdateFeeScheduleLineInput {
  schoolId: ID!
  id: ID!
  feeScheduleId: ID!
  feeItemId: ID!
  amount: Float!
  isOptionalOverride: Boolean
  dueDate: AWSDate
  sortOrder: Int!
}

input GenerateClassInvoicesInput {
  schoolId: ID!
  sessionId: ID
  termId: ID!
  classGroupId: ID!
  feeScheduleId: ID!
  dueAt: AWSDateTime
  limit: Int
  skipDuplicates: Boolean = true
}

input CreateInvoiceInput {
  schoolId: ID!
  studentId: ID!
  enrollmentId: ID
  sessionId: ID!
  termId: ID!
  classGroupId: ID
  feeScheduleId: ID
  dueAt: AWSDateTime
}

input SelectInvoiceOptionalItemsInput {
  schoolId: ID!
  invoiceId: ID!
  selectedLineIds: [ID!]!
}

input CreatePaymentIntentInput {
  schoolId: ID!
  invoiceId: ID!
  payerParentId: ID
  provider: PaymentProvider!
  amount: Float!
  currency: String!
  status: PaymentIntentStatus!
  externalReference: String
}

input UpdatePaymentIntentInput {
  schoolId: ID!
  id: ID!
  status: PaymentIntentStatus
  externalReference: String
  providerReference: String
  redirectedAt: AWSDateTime
  confirmedAt: AWSDateTime
  failedAt: AWSDateTime
  updatedAt: AWSDateTime
}

input CreatePaymentTransactionInput {
  schoolId: ID!
  invoiceId: ID
  subscriptionId: ID
  paymentIntentId: ID
  provider: PaymentProvider!
  method: PaymentMethod
  amount: Float!
  currency: String!
  status: PaymentTxnStatus!
  reference: String!
  providerReference: String
  type: PaymentTransactionType
  environment: String
  metadata: AWSJSON
  providerResponse: AWSJSON
  processedAt: AWSDateTime
}

input CreateManualPaymentProofUploadUrlInput {
  schoolId: ID!
  fileName: String!
  contentType: String = "image/jpeg"
}

input CreateReceiptUploadUrlInput {
  schoolId: ID!
  receiptNo: String!
  fileName: String
  contentType: String = "application/pdf"
}

input CreateReceiptDownloadUrlInput {
  schoolId: ID!
  receiptNo: String!
}

input SubmitManualPaymentProofInput {
  schoolId: ID!
  invoiceId: ID!
  amount: Float!
  currency: String!
  fileUrl: String!
  submittedByParentId: ID
}

input ReviewManualPaymentProofInput {
  schoolId: ID!
  proofId: ID!
  reviewerUserId: ID!
  status: ProofStatus!
  notes: String
}

input AttachReceiptUrlInput {
  schoolId: ID!
  receiptNo: String!
  receiptUrl: String!
  receiptBucket: String!
  receiptKey: String!
}

input CreateMessageTemplateInput {
  schoolId: ID!
  type: String!
  channel: MessageChannel!
  subject: String
  body: String!
  variablesJson: AWSJSON
  isActive: Boolean = true
}

input UpdateMessageTemplateInput {
  schoolId: ID!
  id: ID!
  type: String
  channel: MessageChannel
  subject: String
  body: String
  variablesJson: AWSJSON
  isActive: Boolean
}

input CreateMessageCampaignInput {
  schoolId: ID!
  name: String!
  type: String!
  channel: MessageChannel!
  templateId: ID
  createdByUserId: ID!
  scheduledAt: AWSDateTime
  audienceJson: AWSJSON
}

input CreateSupportTicketInput {
  schoolId: ID!
  parentId: ID!
  studentId: ID
  subject: String!
  category: String!
  detail: String!
}

input UpdateSupportTicketStatusInput {
  schoolId: ID!
  id: ID!
  status: SupportTicketStatus!
}

input CreateSupportTicketMessageInput {
  schoolId: ID!
  ticketId: ID!
  authorType: SupportTicketAuthorType!
  authorId: ID!
  body: String!
}
