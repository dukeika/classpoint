# ClassPoint API - Production Environment Configuration
# IMPORTANT: Never commit actual production values to version control
# Use AWS Secrets Manager, Parameter Store, or environment variables

# ======================
# Application
# ======================
NODE_ENV=production
PORT=3000
API_PREFIX=/api/v1

# ======================
# Database
# ======================
# Use AWS RDS PostgreSQL connection string
DATABASE_URL="postgresql://classpoint_prod:${DB_PASSWORD}@classpoint-prod.xxxxx.us-east-1.rds.amazonaws.com:5432/classpoint?schema=public&connection_limit=20&pool_timeout=30"

# Production Pool Settings
DATABASE_POOL_MIN=5
DATABASE_POOL_MAX=50
DATABASE_POOL_IDLE_TIMEOUT=30000

# Enable SSL for RDS
DATABASE_SSL=true
DATABASE_SSL_REJECT_UNAUTHORIZED=false

# ======================
# Authentication
# ======================
# CRITICAL: Use strong secrets from AWS Secrets Manager
JWT_SECRET=${AWS_SECRET:jwt-secret}
JWT_EXPIRES_IN=24h
JWT_REFRESH_EXPIRES_IN=7d

# AWS Cognito Production Pool
AWS_REGION=us-east-1
AWS_COGNITO_USER_POOL_ID=${AWS_COGNITO_PROD_POOL_ID}
AWS_COGNITO_CLIENT_ID=${AWS_COGNITO_PROD_CLIENT_ID}
AWS_COGNITO_ISSUER=https://cognito-idp.us-east-1.amazonaws.com/${AWS_COGNITO_PROD_POOL_ID}

# ======================
# AWS Services
# ======================
# Use IAM roles instead of access keys when possible
AWS_S3_BUCKET=classpoint-resources-prod
AWS_S3_REGION=us-east-1

# If IAM roles not available
AWS_ACCESS_KEY_ID=${AWS_SECRET:aws-access-key}
AWS_SECRET_ACCESS_KEY=${AWS_SECRET:aws-secret-key}

# Shorter expiration for production
S3_PRESIGNED_URL_EXPIRES=1800

# ======================
# Email Service
# ======================
AWS_SES_REGION=us-east-1
EMAIL_FROM=noreply@classpoint.ng
EMAIL_REPLY_TO=support@classpoint.ng

# ======================
# SMS Service
# ======================
SMS_PROVIDER=twilio
TWILIO_ACCOUNT_SID=${AWS_SECRET:twilio-sid}
TWILIO_AUTH_TOKEN=${AWS_SECRET:twilio-token}
TWILIO_PHONE_NUMBER=+27123456789

# ======================
# Rate Limiting (Stricter for Production)
# ======================
THROTTLE_TTL=60
THROTTLE_LIMIT=50

# API Key rate limiting
API_KEY_THROTTLE_TTL=3600
API_KEY_THROTTLE_LIMIT=1000

# ======================
# CORS Configuration
# ======================
CORS_ORIGIN=https://app.classpoint.ng,https://www.classpoint.ng
CORS_CREDENTIALS=true

# ======================
# Logging
# ======================
LOG_LEVEL=warn
LOG_FORMAT=json

# Sentry Production
SENTRY_DSN=${AWS_SECRET:sentry-dsn}
SENTRY_ENVIRONMENT=production
SENTRY_TRACES_SAMPLE_RATE=0.1

# CloudWatch Logs
AWS_CLOUDWATCH_LOG_GROUP=/aws/classpoint/api
AWS_CLOUDWATCH_LOG_STREAM=production

# ======================
# Security
# ======================
# Strict security headers
HELMET_ENABLED=true
HELMET_HSTS_MAX_AGE=31536000
HELMET_HSTS_INCLUDE_SUBDOMAINS=true
HELMET_HSTS_PRELOAD=true

# CSRF Protection
CSRF_ENABLED=true
CSRF_COOKIE_SECURE=true
CSRF_COOKIE_HTTP_ONLY=true
CSRF_COOKIE_SAME_SITE=strict

# Password Policy (Strict)
PASSWORD_MIN_LENGTH=12
PASSWORD_REQUIRE_UPPERCASE=true
PASSWORD_REQUIRE_LOWERCASE=true
PASSWORD_REQUIRE_NUMBERS=true
PASSWORD_REQUIRE_SYMBOLS=true
PASSWORD_MAX_AGE_DAYS=90

# Session Security
SESSION_COOKIE_SECURE=true
SESSION_COOKIE_HTTP_ONLY=true
SESSION_COOKIE_SAME_SITE=strict
SESSION_MAX_AGE=86400000

# ======================
# Feature Flags
# ======================
FEATURE_CALENDAR_ENABLED=true
FEATURE_RESOURCES_ENABLED=true
FEATURE_ANALYTICS_ENABLED=true
FEATURE_EXPORT_ENABLED=true
FEATURE_IMPORT_ENABLED=true

# ======================
# Cache Configuration
# ======================
# ElastiCache Redis
REDIS_HOST=classpoint-prod.xxxxx.cache.amazonaws.com
REDIS_PORT=6379
REDIS_PASSWORD=${AWS_SECRET:redis-password}
REDIS_DB=0
REDIS_TLS=true

# Cache TTL (seconds)
CACHE_TTL_SHORT=300
CACHE_TTL_MEDIUM=3600
CACHE_TTL_LONG=86400

# ======================
# File Upload Limits
# ======================
MAX_FILE_SIZE=52428800
MAX_FILES_PER_UPLOAD=20
ALLOWED_FILE_TYPES=image/*,application/pdf,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet

# ======================
# Monitoring & Health
# ======================
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_PATH=/health
METRICS_ENABLED=true
METRICS_PATH=/metrics

# New Relic Production
NEW_RELIC_LICENSE_KEY=${AWS_SECRET:newrelic-license}
NEW_RELIC_APP_NAME=ClassPoint-API-Production
NEW_RELIC_LOG_LEVEL=info

# AWS X-Ray Tracing
AWS_XRAY_ENABLED=true
AWS_XRAY_DAEMON_ADDRESS=localhost:2000

# ======================
# Backup Configuration
# ======================
BACKUP_ENABLED=true
BACKUP_SCHEDULE=0 2 * * *
BACKUP_RETENTION_DAYS=90
BACKUP_S3_BUCKET=classpoint-backups-prod
BACKUP_ENCRYPTION=true

# Point-in-time Recovery
PITR_ENABLED=true
PITR_RETENTION_DAYS=35

# ======================
# Performance
# ======================
# Enable compression
COMPRESSION_ENABLED=true
COMPRESSION_LEVEL=6

# Query optimization
QUERY_TIMEOUT=30000
STATEMENT_TIMEOUT=60000

# ======================
# Compliance & Audit
# ======================
AUDIT_LOG_ENABLED=true
AUDIT_LOG_S3_BUCKET=classpoint-audit-logs
AUDIT_LOG_RETENTION_DAYS=2555

# GDPR Compliance
GDPR_DATA_RETENTION_DAYS=730
GDPR_EXPORT_ENABLED=true
GDPR_DELETE_ENABLED=true

# ======================
# Disaster Recovery
# ======================
DR_BACKUP_REGION=us-west-2
DR_REPLICATION_ENABLED=true
DR_FAILOVER_ENABLED=true
